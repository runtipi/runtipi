version: '3.7'
services:
  wg-easy:
      container_name: wg-easy
      image: 'weejewel/wg-easy:latest'
      restart: unless-stopped
      volumes:
        - ${APP_DATA_DIR}:/etc/wireguard
      ports:
        - 51820:51820
        - ${APP_WGEASY_PORT}:51821
      environment:
        WG_HOST: '${WIREGUARD_HOST}'
        PASSWORD: '${WIREGUARD_PASSWORD}'
      cap_add:
        - NET_ADMIN
        - SYS_MODULE
      sysctls:
        - net.ipv4.conf.all.src_valid_mark=1
        - net.ipv4.ip_forward=1
      networks:
        - tipi_main_network
      # labels:
      #   traefik.enable: true
      #   traefik.http.routers.wireguard.rule: Host(`wireguard.tipi.home`)
      #   traefik.http.routers.wireguard.service: wireguard
      #   traefik.http.routers.wireguard.tls: true
      #   traefik.http.routers.wireguard.entrypoints: websecure
      #   traefik.http.services.wireguard.loadbalancer.server.port: 51821
